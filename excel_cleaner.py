import pandas as pd
import sys
import os

def clear_responses_data(file_path):
    """
    ูููู ุจุฅูุดุงุก ููู ุฅูุณู ุฌุฏูุฏ ููุงุฑุบ ูุญุชูู ููุท ุนูู ุตู ุงูุนูุงููู ุงูุตุญูุญ.
    ูุฐุง ูุถูู ุฅุนุงุฏุฉ ุชุนููู ุงูููู ุฅูู ุญุงูุชู ุงูุฃูููุฉ ุงููุธููุฉ ุฏุงุฆููุง.
    """
    # ๐ฅ ุชุญุฏูุซ: ูุฐู ุงููุงุฆูุฉ ูู "ูุตุฏุฑ ุงูุญูููุฉ" ูุดูู ุงูููู ุงููุงุฑุบ
    # โ๏ธ ูุงู: ูุฌุจ ุฃู ุชููู ูุฐู ุงููุงุฆูุฉ ูุทุงุจูุฉ ุชูุงููุง ููุงุฆูุฉ column_order ูู app.py
    column_order = [
        "ุงูุจุฑูุฏ ุงูุฅููุชุฑููู", "ุงุณู ุงููุทุงุน", "ุงูุฅุฏุงุฑุฉ ุงูุชูููุฐูุฉ", "ุงูุฅุฏุงุฑุฉ", "ุงููุณู",
        "ูู ุชูุฌุฏ ุฃูุดุทุฉุ", "ููุถูุน ุงููุดุงุท", "ููุน ุงููุดุงุท", "ูุฏู ุงุณุชุฑุงุชูุฌู 1", 
        "ูุฏู ุงุณุชุฑุงุชูุฌู 2", "ุชุตููู ุงูููุฏู", "ุชุงุฑูุฎ ุจุฏุงูุฉ ุงููุดุงุท", "ุชุงุฑูุฎ ููุงูุฉ ุงููุดุงุท",
        "ุงุณู ุงูููุฏู", "ูุณุคูู ุงูุญุถูุฑ", "ุงููุฆุฉ ุงููุณุชูุฏูุฉ (ุงูููุน)", "ุงููุฆุฉ ุงููุณุชูุฏูุฉ (ุชูุงุตูู)",
        "ุนุฏุฏ ุงูุญุถูุฑ", "ูุฏุฉ ุงููุดุงุท (ุณุงุนุฉ)", "ููุงู ุงูุญูุธ", "ุชุงุฑูุฎ ุงูุฅุฑุณุงู"
    ]

    try:
        # ุฅูุดุงุก DataFrame ูุงุฑุบ ูุน ุงูุฃุนูุฏุฉ ุงูุตุญูุญุฉ
        header_df = pd.DataFrame(columns=column_order)
        
        # ุงุณุชุฎุฏุงู ExcelWriter ูุญูุธ ุงูููู ูุน ุชูุนูู ุฎูุงุฑ RTL
        writer = pd.ExcelWriter(file_path, engine='xlsxwriter')
        
        header_df.to_excel(writer, sheet_name='ุงูุฑุฏูุฏ', index=False)
        
        worksheet = writer.sheets['ุงูุฑุฏูุฏ']
        worksheet.right_to_left()
        
        writer.close()
        print(f"Success: File reset completed for {file_path}.")
        
    except Exception as e:
        print(f"An unexpected error occurred during reset: {e}")

if __name__ == "__main__":
    if len(sys.argv) < 2:
        print("Usage: python excel_cleaner.py <path_to_excel_file>")
        sys.exit(1)
        
    file_to_clear = sys.argv[1]
    clear_responses_data(file_to_clear)